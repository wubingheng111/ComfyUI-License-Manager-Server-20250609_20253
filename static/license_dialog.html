<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComfyUI è®¸å¯è¯ç®¡ç†</title>
    <link rel="stylesheet" href="/license_static/style.css">
    <!-- å¼•å…¥å›¾æ ‡åº“ -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
</head>
<body>
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-decoration">
        <div class="bg-circle circle-1"></div>
        <div class="bg-circle circle-2"></div>
        <div class="bg-circle circle-3"></div>
    </div>

    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="logo">
                <i class="ri-shield-check-line"></i>
            </div>
            <h1>ComfyUI è®¸å¯è¯ç®¡ç†</h1>
            <p>ç®¡ç†æ‚¨çš„è®¸å¯è¯å¯†é’¥ï¼Œäº«å—ä¸“ä¸šAIæœåŠ¡</p>
        </div>
        
        <!-- å½“å‰å¡å¯†çŠ¶æ€ -->
        <div class="section current-license-section">
            <div class="section-header">
                <h3><i class="ri-vip-crown-line"></i>å½“å‰æˆæƒ</h3>
                <div class="license-status" id="licenseStatus">
                    <span class="status-indicator" id="statusIndicator"></span>
                    <span id="statusText">æœªæ¿€æ´»</span>
                </div>
            </div>
            
            <div class="license-card" id="licenseCard">
                <div class="license-info">
                    <div class="info-row">
                        <label>å¡å¯†:</label>
                        <div class="license-key-display">
                            <input type="text" id="currentLicense" readonly placeholder="æš‚æ— æœ‰æ•ˆå¡å¯†">
                            <button class="copy-btn" onclick="copyLicense()" title="å¤åˆ¶å¡å¯†">
                                <i class="ri-file-copy-line"></i>
                            </button>
                        </div>
                    </div>
                    <div class="license-details" id="licenseDetails" style="display: none;">
                        <div class="detail-grid">
                            <div class="detail-item">
                                <i class="ri-user-line"></i>
                                <span class="label">ç”¨æˆ·ID</span>
                                <span class="value" id="userIdDisplay">-</span>
                            </div>
                            <div class="detail-item">
                                <i class="ri-time-line"></i>
                                <span class="label">å‰©ä½™å¤©æ•°</span>
                                <span class="value" id="daysDisplay">-</span>
                            </div>
                            <div class="detail-item">
                                <i class="ri-refresh-line"></i>
                                <span class="label">å‰©ä½™æ¬¡æ•°</span>
                                <span class="value" id="usageDisplay">-</span>
                            </div>
                            <div class="detail-item">
                                <i class="ri-star-line"></i>
                                <span class="label">æˆæƒåŠŸèƒ½</span>
                                <span class="value" id="featuresDisplay">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="license-actions">
                    <button class="btn btn-outline" onclick="refreshLicenseInfo()">
                        <i class="ri-refresh-line"></i>åˆ·æ–°ä¿¡æ¯
                    </button>
                    <button class="btn btn-danger" onclick="clearLicense()">
                        <i class="ri-delete-bin-line"></i>æ¸…é™¤å¡å¯†
                    </button>
                </div>
            </div>
        </div>
        
        <!-- éªŒè¯æ–°å¡å¯† -->
        <div class="section verify-section">
            <div class="section-header">
                <h3><i class="ri-key-line"></i>éªŒè¯å¡å¯†</h3>
                <div class="help-tip" title="è¾“å…¥æ–°çš„å¡å¯†è¿›è¡ŒéªŒè¯å’Œæ¿€æ´»">
                    <i class="ri-question-line"></i>
                </div>
            </div>
            
            <div class="input-group">
                <div class="input-wrapper">
                    <i class="ri-key-2-line input-icon"></i>
                    <input 
                        type="text" 
                        id="newLicense" 
                        placeholder="è¯·è¾“å…¥æ‚¨çš„æˆæƒå¡å¯†..." 
                        maxlength="200"
                        autocomplete="off"
                    >
                    <div class="input-actions">
                        <button class="paste-btn" onclick="pasteFromClipboard()" title="ä»å‰ªè´´æ¿ç²˜è´´">
                            <i class="ri-clipboard-line"></i>
                        </button>
                        <button class="clear-input-btn" onclick="clearInput()" title="æ¸…ç©ºè¾“å…¥">
                            <i class="ri-close-line"></i>
                        </button>
                    </div>
                </div>
                <div class="input-hint" id="inputHint">æ”¯æŒå„ç§æ ¼å¼çš„å¡å¯†ï¼Œè¯·ç¡®ä¿è¾“å…¥å®Œæ•´</div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="validateLicense()">
                    <i class="ri-shield-check-line"></i>
                    <span>éªŒè¯å¡å¯†</span>
                    <div class="btn-loading" style="display: none;">
                        <i class="ri-loader-line loading-spin"></i>
                    </div>
                </button>
                <button class="btn btn-outline" onclick="checkLicenseInfo()">
                    <i class="ri-search-line"></i>æŸ¥è¯¢ä¿¡æ¯
                </button>
            </div>
        </div>
        
        <!-- å¿«é€Ÿæ“ä½œ -->
        <div class="section quick-actions-section">
            <div class="section-header">
                <h3><i class="ri-dashboard-line"></i>å¿«é€Ÿæ“ä½œ</h3>
            </div>
            
            <div class="action-grid">
                <div class="action-card" onclick="getLicenseStats()">
                    <div class="action-icon">
                        <i class="ri-bar-chart-line"></i>
                    </div>
                    <div class="action-content">
                        <h4>ç»Ÿè®¡ä¿¡æ¯</h4>
                        <p>æŸ¥çœ‹ç³»ç»Ÿä½¿ç”¨ç»Ÿè®¡</p>
                    </div>
                </div>
                
                <div class="action-card" onclick="testConnection()">
                    <div class="action-icon">
                        <i class="ri-wifi-line"></i>
                    </div>
                    <div class="action-content">
                        <h4>è¿æ¥æµ‹è¯•</h4>
                        <p>æµ‹è¯•æœåŠ¡å™¨è¿æ¥</p>
                    </div>
                </div>
                
                <div class="action-card" onclick="exportLogs()">
                    <div class="action-icon">
                        <i class="ri-download-line"></i>
                    </div>
                    <div class="action-content">
                        <h4>å¯¼å‡ºæ—¥å¿—</h4>
                        <p>ä¸‹è½½ä½¿ç”¨è®°å½•</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç»Ÿè®¡ä¿¡æ¯å±•ç¤º -->
        <div class="section stats-section" id="statsSection" style="display: none;">
            <div class="section-header">
                <h3><i class="ri-pie-chart-line"></i>ä½¿ç”¨ç»Ÿè®¡</h3>
                <button class="close-btn" onclick="hideStats()">
                    <i class="ri-close-line"></i>
                </button>
            </div>
            <div id="statsResult"></div>
        </div>
        
        <!-- è”ç³»è´­ä¹° -->
        <div class="section contact-section">
            <div class="section-header">
                <h3><i class="ri-customer-service-line"></i>è´­ä¹°å¡å¯† / è”ç³»æˆ‘ä»¬</h3>
            </div>
            <p class="contact-description">éœ€è¦è´­ä¹°å¡å¯†æˆ–é‡åˆ°é—®é¢˜ï¼Ÿè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬</p>
            
            <div class="contact-grid">
                <div class="contact-card" onclick="copyContact('qq')">
                    <div class="contact-icon qq">
                        <i class="ri-qq-line"></i>
                    </div>
                    <div class="contact-info">
                        <div class="contact-label">QQ</div>
                        <div class="contact-value" id="qqValue">123456789</div>
                    </div>
                    <div class="contact-action">
                        <i class="ri-file-copy-line"></i>
                    </div>
                </div>
                
                <div class="contact-card" onclick="copyContact('wechat')">
                    <div class="contact-icon wechat">
                        <i class="ri-wechat-line"></i>
                    </div>
                    <div class="contact-info">
                        <div class="contact-label">å¾®ä¿¡</div>
                        <div class="contact-value" id="wechatValue">your_wechat_id</div>
                    </div>
                    <div class="contact-action">
                        <i class="ri-file-copy-line"></i>
                    </div>
                </div>
                
                <div class="contact-card" onclick="copyContact('email')">
                    <div class="contact-icon email">
                        <i class="ri-mail-line"></i>
                    </div>
                    <div class="contact-info">
                        <div class="contact-label">é‚®ç®±</div>
                        <div class="contact-value" id="emailValue">support@example.com</div>
                    </div>
                    <div class="contact-action">
                        <i class="ri-file-copy-line"></i>
                    </div>
                </div>
                
                <div class="contact-card" onclick="openWebsite()">
                    <div class="contact-icon website">
                        <i class="ri-global-line"></i>
                    </div>
                    <div class="contact-info">
                        <div class="contact-label">å®˜ç½‘</div>
                        <div class="contact-value" id="websiteValue">www.example.com</div>
                    </div>
                    <div class="contact-action">
                        <i class="ri-external-link-line"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- çŠ¶æ€æ¶ˆæ¯ -->
        <div id="status" class="status-message"></div>
        
        <!-- Toast é€šçŸ¥ -->
        <div id="toast" class="toast">
            <div class="toast-content">
                <div class="toast-icon">
                    <i class="ri-check-line"></i>
                </div>
                <div class="toast-text"></div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentLicenseInfo = null;
        let isValidating = false;

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            loadCurrentLicense();
            setupEventListeners();
        });

        // åˆå§‹åŒ–é¡µé¢
        function initializePage() {
            // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
            document.body.classList.add('loaded');
            
            // è®¾ç½®éšæœºèƒŒæ™¯åœ†åœˆåŠ¨ç”»
            animateBackgroundCircles();
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // å›è½¦é”®éªŒè¯
            document.getElementById('newLicense').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !isValidating) {
                    validateLicense();
                }
            });

            // è¾“å…¥æ¡†å˜åŒ–ç›‘å¬
            document.getElementById('newLicense').addEventListener('input', function(e) {
                const value = e.target.value.trim();
                const hint = document.getElementById('inputHint');
                
                if (value.length === 0) {
                    hint.textContent = 'æ”¯æŒå„ç§æ ¼å¼çš„å¡å¯†ï¼Œè¯·ç¡®ä¿è¾“å…¥å®Œæ•´';
                    hint.className = 'input-hint';
                } else if (value.length < 10) {
                    hint.textContent = 'å¡å¯†é•¿åº¦ä¼¼ä¹è¿‡çŸ­ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å®Œæ•´';
                    hint.className = 'input-hint warning';
                } else {
                    hint.textContent = 'å¡å¯†æ ¼å¼æ­£ç¡®ï¼Œå¯ä»¥è¿›è¡ŒéªŒè¯';
                    hint.className = 'input-hint success';
                }
            });
        }

        // èƒŒæ™¯åœ†åœˆåŠ¨ç”»
        function animateBackgroundCircles() {
            const circles = document.querySelectorAll('.bg-circle');
            circles.forEach((circle, index) => {
                circle.style.animationDelay = `${index * 0.5}s`;
            });
        }

        // åŠ è½½å½“å‰å¡å¯†
        function loadCurrentLicense() {
            const currentKey = localStorage.getItem('comfyui_license_key');
            if (currentKey) {
                document.getElementById('currentLicense').value = currentKey;
                updateLicenseStatus('active');
                // è‡ªåŠ¨è·å–å¡å¯†ä¿¡æ¯
                setTimeout(() => {
                    checkLicenseInfo(currentKey, true);
                }, 500);
            } else {
                updateLicenseStatus('inactive');
            }
        }

        // æ›´æ–°è®¸å¯è¯çŠ¶æ€
        function updateLicenseStatus(status, info = null) {
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            const licenseDetails = document.getElementById('licenseDetails');

            switch (status) {
                case 'active':
                    statusIndicator.className = 'status-indicator active';
                    statusText.textContent = 'å·²æ¿€æ´»';
                    break;
                case 'expired':
                    statusIndicator.className = 'status-indicator expired';
                    statusText.textContent = 'å·²è¿‡æœŸ';
                    break;
                case 'inactive':
                default:
                    statusIndicator.className = 'status-indicator inactive';
                    statusText.textContent = 'æœªæ¿€æ´»';
                    break;
            }

            if (info) {
                updateLicenseDetails(info);
                licenseDetails.style.display = 'block';
            } else {
                licenseDetails.style.display = 'none';
            }
        }

        // æ›´æ–°è®¸å¯è¯è¯¦æƒ…
        function updateLicenseDetails(info) {
            document.getElementById('userIdDisplay').textContent = info.user_id || '-';
            document.getElementById('daysDisplay').textContent = 
                info.days_remaining === -1 ? 'æ°¸ä¹…' : `${info.days_remaining}å¤©`;
            document.getElementById('usageDisplay').textContent = 
                info.usage_remaining === -1 ? 'æ— é™åˆ¶' : `${info.usage_remaining}æ¬¡`;
            document.getElementById('featuresDisplay').textContent = 
                Array.isArray(info.features) ? info.features.join(', ') : (info.features || '-');
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type = 'info', duration = 5000) {
            const status = document.getElementById('status');
            const icon = getMessageIcon(type);
            
            status.innerHTML = `
                <div class="message-content">
                    <i class="${icon}"></i>
                    <span>${message}</span>
                </div>
            `;
            status.className = `status-message ${type} show`;
            
            setTimeout(() => {
                status.classList.remove('show');
            }, duration);
        }

        // æ˜¾ç¤º Toast é€šçŸ¥
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const icon = toast.querySelector('.toast-icon i');
            const text = toast.querySelector('.toast-text');
            
            icon.className = getMessageIcon(type);
            text.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // è·å–æ¶ˆæ¯å›¾æ ‡
        function getMessageIcon(type) {
            const icons = {
                success: 'ri-check-line',
                error: 'ri-error-warning-line',
                warning: 'ri-alert-line',
                info: 'ri-information-line'
            };
            return icons[type] || icons.info;
        }

        // è®¾ç½®æŒ‰é’®åŠ è½½çŠ¶æ€
        function setButtonLoading(button, loading) {
            const text = button.querySelector('span');
            const loader = button.querySelector('.btn-loading');
            
            if (loading) {
                button.disabled = true;
                if (text) text.style.opacity = '0';
                if (loader) loader.style.display = 'block';
            } else {
                button.disabled = false;
                if (text) text.style.opacity = '1';
                if (loader) loader.style.display = 'none';
            }
        }

        // éªŒè¯å¡å¯†
        async function validateLicense() {
            if (isValidating) return;
            
            const key = document.getElementById('newLicense').value.trim();
            if (!key) {
                showMessage('è¯·è¾“å…¥å¡å¯†', 'warning');
                return;
            }
            
            isValidating = true;
            const validateBtn = document.querySelector('.btn-primary');
            setButtonLoading(validateBtn, true);
            
            showMessage('æ­£åœ¨éªŒè¯å¡å¯†...', 'info');
            
            try {
                const response = await fetch('/license/validate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ license_key: key })
                });
                
                const result = await response.json();
                
                if (result.valid) {
                    localStorage.setItem('comfyui_license_key', key);
                    document.getElementById('currentLicense').value = key;
                    document.getElementById('newLicense').value = '';
                    
                    currentLicenseInfo = result.license_info;
                    updateLicenseStatus('active', currentLicenseInfo);
                    
                    showToast('å¡å¯†éªŒè¯æˆåŠŸï¼', 'success');
                    showMessage('ğŸ‰ å¡å¯†éªŒè¯æˆåŠŸï¼æˆæƒå·²æ¿€æ´»', 'success');
                } else {
                    showMessage('âŒ ' + (result.message || 'å¡å¯†éªŒè¯å¤±è´¥'), 'error');
                }
            } catch (error) {
                showMessage('âŒ éªŒè¯è¯·æ±‚å¤±è´¥: ' + error.message, 'error');
            } finally {
                isValidating = false;
                setButtonLoading(validateBtn, false);
            }
        }

        // æŸ¥è¯¢å¡å¯†ä¿¡æ¯
        async function checkLicenseInfo(customKey = null, silent = false) {
            const key = customKey || 
                       document.getElementById('newLicense').value.trim() || 
                       document.getElementById('currentLicense').value.trim();
            
            if (!key) {
                if (!silent) showMessage('è¯·è¾“å…¥è¦æŸ¥è¯¢çš„å¡å¯†', 'warning');
                return;
            }
            
            if (!silent) showMessage('æ­£åœ¨æŸ¥è¯¢å¡å¯†ä¿¡æ¯...', 'info');
            
            try {
                const response = await fetch('/license/check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ license_key: key })
                });
                
                const result = await response.json();
                
                if (response.ok && result.user_id) {
                    currentLicenseInfo = result;
                    updateLicenseDetails(result);
                    document.getElementById('licenseDetails').style.display = 'block';
                    
                    if (!silent) {
                        showToast('ä¿¡æ¯æŸ¥è¯¢æˆåŠŸ', 'success');
                    }
                } else {
                    if (!silent) {
                        showMessage('âŒ ' + (result.error || 'æŸ¥è¯¢å¤±è´¥'), 'error');
                    }
                }
            } catch (error) {
                if (!silent) {
                    showMessage('âŒ æŸ¥è¯¢è¯·æ±‚å¤±è´¥: ' + error.message, 'error');
                }
            }
        }

        // åˆ·æ–°è®¸å¯è¯ä¿¡æ¯
        function refreshLicenseInfo() {
            const currentKey = document.getElementById('currentLicense').value.trim();
            if (currentKey) {
                checkLicenseInfo(currentKey);
            } else {
                showMessage('æ²¡æœ‰å¯åˆ·æ–°çš„å¡å¯†', 'warning');
            }
        }

        // è·å–ç»Ÿè®¡ä¿¡æ¯
        async function getLicenseStats() {
            showMessage('æ­£åœ¨è·å–ç»Ÿè®¡ä¿¡æ¯...', 'info');
            
            try {
                const response = await fetch('/license/stats');
                const result = await response.json();
                
                if (response.ok) {
                    displayStats(result);
                    document.getElementById('statsSection').style.display = 'block';
                    document.getElementById('statsSection').scrollIntoView({ behavior: 'smooth' });
                    showToast('ç»Ÿè®¡ä¿¡æ¯è·å–æˆåŠŸ', 'success');
                } else {
                    showMessage('âŒ è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('âŒ è¯·æ±‚å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
        function displayStats(stats) {
            const statsDiv = document.getElementById('statsResult');
            statsDiv.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="ri-pie-chart-line"></i></div>
                        <div class="stat-info">
                            <div class="stat-value">${stats.total_validations || 0}</div>
                            <div class="stat-label">æ€»éªŒè¯æ¬¡æ•°</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon success"><i class="ri-check-line"></i></div>
                        <div class="stat-info">
                            <div class="stat-value">${stats.successful_validations || 0}</div>
                            <div class="stat-label">æˆåŠŸéªŒè¯</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon error"><i class="ri-close-line"></i></div>
                        <div class="stat-info">
                            <div class="stat-value">${stats.failed_validations || 0}</div>
                            <div class="stat-label">å¤±è´¥éªŒè¯</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="ri-user-line"></i></div>
                        <div class="stat-info">
                            <div class="stat-value">${stats.active_licenses || 0}</div>
                            <div class="stat-label">æ´»è·ƒå¡å¯†</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // éšè—ç»Ÿè®¡ä¿¡æ¯
        function hideStats() {
            document.getElementById('statsSection').style.display = 'none';
        }

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            showMessage('æ­£åœ¨æµ‹è¯•è¿æ¥...', 'info');
            
            try {
                const startTime = Date.now();
                const response = await fetch('/license/stats');
                const endTime = Date.now();
                const latency = endTime - startTime;
                
                if (response.ok) {
                    showToast(`è¿æ¥æ­£å¸¸ (${latency}ms)`, 'success');
                } else {
                    showMessage('è¿æ¥æµ‹è¯•å¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('âŒ è¿æ¥å¤±è´¥: ' + error.message, 'error');
            }
        }

        // å¯¼å‡ºæ—¥å¿—
        function exportLogs() {
            showToast('æ—¥å¿—å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // æ¸…é™¤å¡å¯†
        function clearLicense() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤å½“å‰å¡å¯†å—ï¼Ÿæ¸…é™¤åéœ€è¦é‡æ–°éªŒè¯æ‰èƒ½ä½¿ç”¨ComfyUIã€‚')) {
                localStorage.removeItem('comfyui_license_key');
                document.getElementById('currentLicense').value = '';
                updateLicenseStatus('inactive');
                currentLicenseInfo = null;
                showToast('å¡å¯†å·²æ¸…é™¤', 'success');
            }
        }

        // å¤åˆ¶å¡å¯†
        async function copyLicense() {
            const license = document.getElementById('currentLicense').value;
            if (!license) {
                showMessage('æ²¡æœ‰å¯å¤åˆ¶çš„å¡å¯†', 'warning');
                return;
            }
            
            try {
                await navigator.clipboard.writeText(license);
                showToast('å¡å¯†å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            } catch (error) {
                // é™çº§æ–¹æ¡ˆ
                const textArea = document.createElement('textarea');
                textArea.value = license;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('å¡å¯†å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }
        }

        // ä»å‰ªè´´æ¿ç²˜è´´
        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                if (text.trim()) {
                    document.getElementById('newLicense').value = text.trim();
                    showToast('å·²ä»å‰ªè´´æ¿ç²˜è´´', 'success');
                    // è§¦å‘è¾“å…¥äº‹ä»¶ä»¥æ›´æ–°æç¤º
                    document.getElementById('newLicense').dispatchEvent(new Event('input'));
                }
            } catch (error) {
                showMessage('å‰ªè´´æ¿è®¿é—®å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨ç²˜è´´', 'warning');
            }
        }

        // æ¸…ç©ºè¾“å…¥
        function clearInput() {
            document.getElementById('newLicense').value = '';
            document.getElementById('inputHint').textContent = 'æ”¯æŒå„ç§æ ¼å¼çš„å¡å¯†ï¼Œè¯·ç¡®ä¿è¾“å…¥å®Œæ•´';
            document.getElementById('inputHint').className = 'input-hint';
        }

        // å¤åˆ¶è”ç³»æ–¹å¼
        async function copyContact(type) {
            const values = {
                qq: document.getElementById('qqValue').textContent,
                wechat: document.getElementById('wechatValue').textContent,
                email: document.getElementById('emailValue').textContent
            };
            
            const value = values[type];
            if (!value) return;
            
            try {
                await navigator.clipboard.writeText(value);
                showToast(`${type.toUpperCase()}å·²å¤åˆ¶åˆ°å‰ªè´´æ¿`, 'success');
            } catch (error) {
                showMessage('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'warning');
            }
        }

        // æ‰“å¼€å®˜ç½‘
        function openWebsite() {
            const website = document.getElementById('websiteValue').textContent;
            if (website && website !== 'www.example.com') {
                window.open(`https://${website}`, '_blank');
            } else {
                showToast('å®˜ç½‘åœ°å€å¾…é…ç½®', 'info');
            }
        }
    </script>
</body>
</html> 